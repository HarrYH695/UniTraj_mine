
Restoring states from the checkpoint path at /nfs/turbo/coe-mcity/hanhy/MTR_data/checkpoints/pretrain.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
Loaded model weights from the checkpoint at /nfs/turbo/coe-mcity/hanhy/MTR_data/checkpoints/pretrain.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.

Validation DataLoader 0:   0%|                                                                                          | 0/322 [00:00<?, ?it/s]
/home/hanhy/ondemand/data/sys/myjobs/UniTraj_mine/unitraj/models/mtr/ops/knn/knn_utils.py:76: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)























































































































































































































































Validation DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████| 322/322 [08:19<00:00,  0.64it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
           Validate metric                         DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  val/agent_types/vehicle_brier_fde             4.555047512054443
   val/agent_types/vehicle_minADE6              1.5674504041671753
   val/agent_types/vehicle_minFDE6              3.8935325145721436
  val/agent_types/vehicle_miss_rate             0.5393538475036621
            val/brier_fde                       4.555047512054443
      val/kalman/easy_brier_fde                  3.62518572807312
       val/kalman/easy_minADE6                  1.2937839031219482
       val/kalman/easy_minFDE6                  2.983614444732666
      val/kalman/easy_miss_rate                 0.4951663017272949
      val/kalman/hard_brier_fde                 8.863581657409668
       val/kalman/hard_minADE6                  2.9575438499450684
       val/kalman/hard_minFDE6                  8.275020599365234
      val/kalman/hard_miss_rate                 0.6654753684997559
     val/kalman/medium_brier_fde                6.325881004333496
      val/kalman/medium_minADE6                 2.151670455932617
      val/kalman/medium_minFDE6                 5.659976482391357
     val/kalman/medium_miss_rate                0.6107471585273743
             val/minADE6                        1.5674504041671753
             val/minFDE6                        3.8935325145721436
            val/miss_rate                       0.5393538475036621
  val/traj_type/left_turn_brier_fde             4.759221076965332
   val/traj_type/left_turn_minADE6              1.6663658618927002
   val/traj_type/left_turn_minFDE6              4.081930637359619
  val/traj_type/left_turn_miss_rate             0.6463664770126343
 val/traj_type/left_u_turn_brier_fde            11.43934154510498
  val/traj_type/left_u_turn_minADE6             3.9171316623687744
  val/traj_type/left_u_turn_minFDE6             10.855016708374023
 val/traj_type/left_u_turn_miss_rate            0.9320755004882812
  val/traj_type/right_turn_brier_fde            8.755897521972656
   val/traj_type/right_turn_minADE6             2.7717041969299316
   val/traj_type/right_turn_minFDE6             8.019020080566406
  val/traj_type/right_turn_miss_rate            0.7306066751480103
 val/traj_type/right_u_turn_brier_fde           9.951947212219238
  val/traj_type/right_u_turn_minADE6            3.576357841491699
  val/traj_type/right_u_turn_minFDE6            9.663687705993652
 val/traj_type/right_u_turn_miss_rate                  1.0
  val/traj_type/stationary_brier_fde            1.6459633111953735
   val/traj_type/stationary_minADE6              0.7982137799263
   val/traj_type/stationary_minFDE6             1.355307936668396
  val/traj_type/stationary_miss_rate           0.17645978927612305
   val/traj_type/straight_brier_fde             3.312150001525879
val/traj_type/straight_left_brier_fde           4.866218566894531
 val/traj_type/straight_left_minADE6            1.668770432472229
 val/traj_type/straight_left_minFDE6            4.207088470458984
val/traj_type/straight_left_miss_rate            0.70753014087677
    val/traj_type/straight_minADE6              1.1837589740753174
    val/traj_type/straight_minFDE6              2.6556293964385986
   val/traj_type/straight_miss_rate             0.4391230642795563
val/traj_type/straight_right_brier_fde          6.4242048263549805
 val/traj_type/straight_right_minADE6           2.1767895221710205
 val/traj_type/straight_right_minFDE6           5.727555274963379
val/traj_type/straight_right_miss_rate          0.7571384906768799
         val/waymo/brier_fde                    4.555047512054443
          val/waymo/minADE6                     1.5674504041671753
          val/waymo/minFDE6                     3.8935325145721436
         val/waymo/miss_rate                    0.5393538475036621
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
VALIDATE Profiler Report
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                         	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                          	|  -              	|  4537           	|  523.03         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  [Strategy]SingleDeviceStrategy.validation_step                                                                                                                 	|  1.211          	|  322            	|  389.95         	|  74.554         	|
|  [Strategy]SingleDeviceStrategy.batch_to_device                                                                                                                 	|  0.17602        	|  322            	|  56.679         	|  10.837         	|
|  [LightningModule]MotionTransformer.transfer_batch_to_device                                                                                                    	|  0.17595        	|  322            	|  56.656         	|  10.832         	|
|  [_EvaluationLoop].val_next                                                                                                                                     	|  0.046145       	|  322            	|  14.859         	|  2.8409         	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                              	|  0.00035475     	|  322            	|  0.11423        	|  0.02184        	|
|  [Callback]TQDMProgressBar.on_validation_start                                                                                                                  	|  0.012598       	|  1              	|  0.012598       	|  0.0024086      	|
|  [LightningModule]MotionTransformer.on_validation_model_eval                                                                                                    	|  0.0074377      	|  1              	|  0.0074377      	|  0.001422       	|
|  [Callback]TQDMProgressBar.on_validation_batch_start                                                                                                            	|  5.6279e-06     	|  322            	|  0.0018122      	|  0.00034648     	|
|  [Callback]ModelSummary.on_validation_batch_end                                                                                                                 	|  4.7504e-06     	|  322            	|  0.0015296      	|  0.00029245     	|
|  [LightningModule]MotionTransformer.on_before_batch_transfer                                                                                                    	|  4.0227e-06     	|  322            	|  0.0012953      	|  0.00024765     	|
|  [LightningModule]MotionTransformer.on_after_batch_transfer                                                                                                     	|  1.802e-06      	|  322            	|  0.00058023     	|  0.00011094     	|
|  [Callback]ModelSummary.on_validation_batch_start                                                                                                               	|  1.7707e-06     	|  322            	|  0.00057017     	|  0.00010901     	|
|  [LightningModule]MotionTransformer.on_validation_batch_end                                                                                                     	|  1.7073e-06     	|  322            	|  0.00054975     	|  0.00010511     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_end  	|  1.3787e-06     	|  322            	|  0.00044394     	|  8.4877e-05     	|
|  [LightningModule]MotionTransformer.on_validation_batch_start                                                                                                   	|  1.1784e-06     	|  322            	|  0.00037944     	|  7.2547e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_batch_start	|  1.1212e-06     	|  322            	|  0.00036103     	|  6.9025e-05     	|
|  [Callback]TQDMProgressBar.on_validation_end                                                                                                                    	|  0.00030458     	|  1              	|  0.00030458     	|  5.8233e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.setup                    	|  0.00013224     	|  1              	|  0.00013224     	|  2.5283e-05     	|
|  [LightningModule]MotionTransformer.on_validation_epoch_end                                                                                                     	|  6.0335e-05     	|  1              	|  6.0335e-05     	|  1.1536e-05     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_end        	|  1.2209e-05     	|  1              	|  1.2209e-05     	|  2.3342e-06     	|
|  [Callback]ModelSummary.on_validation_start                                                                                                                     	|  8.8578e-06     	|  1              	|  8.8578e-06     	|  1.6935e-06     	|
|  [Callback]TQDMProgressBar.setup                                                                                                                                	|  8.204e-06      	|  1              	|  8.204e-06      	|  1.5685e-06     	|
|  [LightningModule]MotionTransformer.on_load_checkpoint                                                                                                          	|  6.9719e-06     	|  1              	|  6.9719e-06     	|  1.333e-06      	|
|  [Callback]TQDMProgressBar.on_validation_epoch_end                                                                                                              	|  6.8797e-06     	|  1              	|  6.8797e-06     	|  1.3153e-06     	|
|  [Callback]ModelSummary.on_validation_end                                                                                                                       	|  6.5817e-06     	|  1              	|  6.5817e-06     	|  1.2584e-06     	|
|  [Callback]TQDMProgressBar.teardown                                                                                                                             	|  5.505e-06      	|  1              	|  5.505e-06      	|  1.0525e-06     	|
|  [Callback]TQDMProgressBar.on_validation_epoch_start                                                                                                            	|  4.041e-06      	|  1              	|  4.041e-06      	|  7.7261e-07     	|
|  [LightningModule]MotionTransformer.on_validation_start                                                                                                         	|  3.783e-06      	|  1              	|  3.783e-06      	|  7.2329e-07     	|
|  [LightningModule]MotionTransformer.setup                                                                                                                       	|  3.2168e-06     	|  1              	|  3.2168e-06     	|  6.1502e-07     	|
|  [Strategy]SingleDeviceStrategy.on_validation_start                                                                                                             	|  2.9327e-06     	|  1              	|  2.9327e-06     	|  5.6072e-07     	|
|  [Callback]ModelSummary.setup                                                                                                                                   	|  2.0182e-06     	|  1              	|  2.0182e-06     	|  3.8586e-07     	|
|  [LightningModule]MotionTransformer.configure_callbacks                                                                                                         	|  1.925e-06      	|  1              	|  1.925e-06      	|  3.6805e-07     	|
|  [Strategy]SingleDeviceStrategy.on_validation_end                                                                                                               	|  1.6969e-06     	|  1              	|  1.6969e-06     	|  3.2443e-07     	|
|  [Callback]ModelSummary.teardown                                                                                                                                	|  1.5441e-06     	|  1              	|  1.5441e-06     	|  2.9523e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_start      	|  1.4035e-06     	|  1              	|  1.4035e-06     	|  2.6834e-07     	|
|  [LightningModule]MotionTransformer.teardown                                                                                                                    	|  1.3169e-06     	|  1              	|  1.3169e-06     	|  2.5178e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.teardown                 	|  1.3057e-06     	|  1              	|  1.3057e-06     	|  2.4964e-07     	|
|  [Callback]ModelSummary.on_validation_epoch_end                                                                                                                 	|  1.2303e-06     	|  1              	|  1.2303e-06     	|  2.3522e-07     	|
|  [LightningModule]MotionTransformer.on_validation_end                                                                                                           	|  1.1809e-06     	|  1              	|  1.1809e-06     	|  2.2578e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_end  	|  1.1269e-06     	|  1              	|  1.1269e-06     	|  2.1545e-07     	|
|  [Callback]ModelSummary.on_validation_epoch_start                                                                                                               	|  1.0384e-06     	|  1              	|  1.0384e-06     	|  1.9854e-07     	|
|  [Callback]ModelCheckpoint{'monitor': None, 'mode': 'min', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None}.on_validation_epoch_start	|  9.6951e-07     	|  1              	|  9.6951e-07     	|  1.8536e-07     	|
|  [LightningModule]MotionTransformer.on_validation_epoch_start                                                                                                   	|  9.2387e-07     	|  1              	|  9.2387e-07     	|  1.7664e-07     	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------