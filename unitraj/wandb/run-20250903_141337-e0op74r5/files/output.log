
Restoring states from the checkpoint path at /nfs/turbo/coe-mcity/hanhy/MTR_data/checkpoints/pretrain.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
Loaded model weights from the checkpoint at /nfs/turbo/coe-mcity/hanhy/MTR_data/checkpoints/pretrain.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/home/hanhy/.conda/envs/ut0/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:215: Using `DistributedSampler` with the dataloaders. During `trainer.validate()`, it is recommended to use `Trainer(devices=1, num_nodes=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices have same batch size in case of uneven inputs.
Validation: |                                                                                                             | 0/? [00:00<?, ?it/s]
/home/hanhy/ondemand/data/sys/myjobs/UniTraj_mine/unitraj/models/mtr/ops/knn/knn_utils.py:76: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)





















































































Validation DataLoader 0:  99%|███████████████████████████████████████████████████████████████████████████████▎| 107/108 [02:50<00:01,  0.63it/s]
VALIDATE Profiler Report
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                         	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                          	|  -              	|  1541           	|  1498.1         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  [Strategy]DDPStrategy.validation_step                                                                                                                          	|  1.2013         	|  108            	|  129.74         	|  8.6603         	|
|  [_EvaluationLoop].val_next                                                                                                                                     	|  0.15015        	|  108            	|  16.216         	|  1.0824         	|
|  [Strategy]DDPStrategy.batch_to_device                                                                                                                          	|  0.12706        	|  108            	|  13.723         	|  0.91603        	|
|  [LightningModule]MotionTransformer.transfer_batch_to_device                                                                                                    	|  0.12697        	|  108            	|  13.713         	|  0.91539        	|
|  [Callback]TQDMProgressBar.on_validation_batch_end                                                                                                              	|  0.0003742      	|  108            	|  0.040414       	|  0.0026977      	|
Validation DataLoader 0: 100%|████████████████████████████████████████████████████████████████████████████████| 108/108 [02:50<00:00,  0.63it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
           Validate metric                         DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  val/agent_types/vehicle_brier_fde              4.54954719543457
   val/agent_types/vehicle_minADE6              1.5661381483078003
   val/agent_types/vehicle_minFDE6               3.8874351978302
  val/agent_types/vehicle_miss_rate             0.5426421761512756
            val/brier_fde                        4.54954719543457
      val/kalman/easy_brier_fde                 3.6224234104156494
       val/kalman/easy_minADE6                  1.2933050394058228
       val/kalman/easy_minFDE6                  2.9790971279144287
      val/kalman/easy_miss_rate                 0.4998568892478943
      val/kalman/hard_brier_fde                 8.449235916137695
       val/kalman/hard_minADE6                   2.91835880279541
       val/kalman/hard_minFDE6                  7.857718467712402
      val/kalman/hard_miss_rate                 0.6606741547584534
     val/kalman/medium_brier_fde                6.3105669021606445
      val/kalman/medium_minADE6                 2.1489808559417725
      val/kalman/medium_minFDE6                 5.644959449768066
     val/kalman/medium_miss_rate                0.6119168400764465
             val/minADE6                        1.5661381483078003
             val/minFDE6                         3.8874351978302
            val/miss_rate                       0.5426421761512756
  val/traj_type/left_turn_brier_fde             4.746297836303711
   val/traj_type/left_turn_minADE6              1.6628540754318237
   val/traj_type/left_turn_minFDE6              4.066927909851074
  val/traj_type/left_turn_miss_rate             0.649776041507721
 val/traj_type/left_u_turn_brier_fde            10.441237449645996
  val/traj_type/left_u_turn_minADE6             3.5540194511413574
  val/traj_type/left_u_turn_minFDE6             9.866286277770996
 val/traj_type/left_u_turn_miss_rate            0.9095744490623474
  val/traj_type/right_turn_brier_fde            8.859498023986816
   val/traj_type/right_turn_minADE6             2.7974231243133545
   val/traj_type/right_turn_minFDE6             8.122495651245117
  val/traj_type/right_turn_miss_rate            0.7353314757347107
 val/traj_type/right_u_turn_brier_fde           10.113675117492676
  val/traj_type/right_u_turn_minADE6            3.6100497245788574
  val/traj_type/right_u_turn_minFDE6            9.791573524475098
 val/traj_type/right_u_turn_miss_rate                  1.0
  val/traj_type/stationary_brier_fde            1.6853679418563843
   val/traj_type/stationary_minADE6             0.8148415088653564
   val/traj_type/stationary_minFDE6             1.3820191621780396
  val/traj_type/stationary_miss_rate           0.18481847643852234
   val/traj_type/straight_brier_fde             3.3011722564697266
val/traj_type/straight_left_brier_fde           4.943220138549805
 val/traj_type/straight_left_minADE6            1.6986654996871948
 val/traj_type/straight_left_minFDE6            4.287498474121094
val/traj_type/straight_left_miss_rate           0.7193494439125061
    val/traj_type/straight_minADE6              1.1812162399291992
    val/traj_type/straight_minFDE6              2.6444826126098633
   val/traj_type/straight_miss_rate             0.4417465925216675
val/traj_type/straight_right_brier_fde          6.288408279418945
 val/traj_type/straight_right_minADE6           2.135326385498047
 val/traj_type/straight_right_minFDE6           5.590922832489014
val/traj_type/straight_right_miss_rate                 0.75
         val/waymo/brier_fde                     4.54954719543457
          val/waymo/minADE6                     1.5661381483078003
          val/waymo/minFDE6                      3.8874351978302
         val/waymo/miss_rate                    0.5426421761512756
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────